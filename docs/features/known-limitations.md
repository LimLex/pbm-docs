# 备份和恢复的已知限制

PBM 支持各种备份和恢复类型。其中一些有已知限制。此页面按备份/恢复类型列出它们，并作为已知限制的单一真实来源。

## 选择性备份和恢复

1. 仅支持**逻辑**备份和恢复。
2. 从版本 2.0.3 开始，在分片集群中支持非分片集合的选择性备份和恢复。从版本 2.1.0 开始支持分片集合。
3. 如果备份中的块分布与现有集合中的块分布不同，则不支持从完整逻辑备份或选择性逻辑备份中选择性恢复分片集合。在这种情况下支持的恢复方法是在执行选择性恢复之前删除目标集合，确保一致地重新创建分片元数据。
4. 不支持分片时间序列集合。
5. 选择性恢复尚不支持多集合事务。但是，如果您使用它们并尝试选择性恢复，它可能会破坏 [ACID](../reference/glossary.md#acid)，因为不会恢复此事务的所有操作。PBM 仅应用与指定命名空间相关的 oplog 事件。因此，从事务的角度来看，数据一致性可能会被破坏。

    例如，您有一个涉及集合 A 和 B 的事务。当您恢复集合 A 时，PBM 仅重放集合 A 的 oplog 事件，并忽略与集合 B 相关的事件。结果，集合 B 的状态保持不变，不再与集合 A 一致。 
    
6. ``admin``、``config`` 和 ``local`` 数据库中的系统集合不能选择性地备份和恢复。您必须进行完整备份和恢复以包含它们。
7. 分片集群不支持选择性时间点恢复。

## 时间点恢复的 Oplog 切片

Oplog 切片是时间点恢复例程的组成部分，使您能够从备份恢复到特定时刻。有关[时间点恢复](point-in-time-recovery.md) 的更多信息。

**对于 MongoDB 5.0 及更高版本**

如果您[重新分片 :octicons-link-external-16:](https://www.mongodb.com/docs/manual/core/sharding-reshard-a-collection/) 集合，请创建新备份并重新启用时间点恢复 oplog 切片以防止数据不一致和恢复失败。

**对于 MongoDB 8.0 及更高版本**

如果您[取消分片集合 :octicons-link-external-16:](https://www.mongodb.com/docs/v8.0/reference/command/unshardCollection/)，请创建新备份并重新启用时间点恢复 oplog 切片以防止数据不一致和恢复失败。

## 从任意开始时间重放 Oplog

如果您重命名整个数据库或集合，oplog 重放将失败。
