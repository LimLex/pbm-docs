# Percona Backup for MongoDB 2.7.0 ({{date.2_7_0}})

[Installation](../installation.md){.md-button}


Percona Backup for MongoDB 是一个分布式、低影响的解决方案，用于创建 MongoDB 分片集群和副本集的一致备份，并将这些备份恢复到特定时间点。

## 发布亮点

此版本主要专注于代码稳定性和错误修复。但是，它也提供以下改进：

### Amazon EKS 中运行的 PBM 的单一身份验证点

现在在 Amazon Elastic Kubernetes Service (EKS) 中运行的 PBM 可以使用与分配给运行 PBM 的 Pod 的服务账户关联的 IAM 角色中的凭据访问 AWS 服务。由于此改进，您不必将凭据传递给每个单独的 Pod，因此基础设施的整体安全性得到提高。

如果您运行 Percona Operator for MongoDB，请考虑以下限制：如果不修改默认 serviceAccount，恢复无法与此功能一起工作。这将在 Operator 的未来版本中改进以涵盖此情况。


## 变更日志

### 改进

* [PBM-1312](https://perconadev.atlassian.net/browse/PBM-1312), [PBM-1362](https://perconadev.atlassian.net/browse/PBM-1362), [PBM-1400](https://perconadev.atlassian.net/browse/PBM-1400) - 允许更改逻辑备份并发性 

* [PBM-1351](https://perconadev.atlassian.net/browse/PBM-1351) - 允许在 Amazon Elastic Kubernetes Service (EKS) 中运行的 PBM 使用来自 AWS 默认堆栈的凭据访问 AWS 服务（感谢 Alexey Torkhov 的贡献）。

* [PBM-1397](https://perconadev.atlassian.net/browse/PBM-1397) - 为物理和增量备份添加文件检查

### 已修复的错误

* [PBM-397](https://perconadev.atlassian.net/browse/PBM-397) - 通过检查和记录意外心跳更新，修复了多个 `pbm-agents` 为同一 `mongod` 进程运行的问题。 

* [PBM-823](https://perconadev.atlassian.net/browse/PBM-823) - 修复了取消备份后文件未从存储中删除的问题。

* [PBM-886](https://perconadev.atlassian.net/browse/PBM-886) - 修复了时间点恢复上传取消期间的数据竞争

* [PBM-921](https://perconadev.atlassian.net/browse/PBM-921) - 通过在恢复视图或时间序列集合之前确保 `system.views` 集合存在，修复了在视图恢复阶段时间点恢复失败的问题。（感谢 Asel Magzhanova 报告此问题）

* [PBM-1114](https://perconadev.atlassian.net/browse/PBM-1114) - 在将逻辑备份标记为完成之前检查备份文件，以确保可以从中恢复

* [PBM-1229](https://perconadev.atlassian.net/browse/PBM-1229) - 修复了外部备份无法完成的问题（感谢 Julien Riou 报告此问题）

* [PBM-1296](https://perconadev.atlassian.net/browse/PBM-1296) - 通过在 oplog 切片期间创建时间序列集合时重用该集合的自动生成的 UUID 进行视图创建，修复了 PBM 在时间点恢复期间失败的问题。

* [PBM-1297](https://perconadev.atlassian.net/browse/PBM-1297) - 通过在 oplog 重放阶段允许创建此集合，修复了如果在 oplog 切片期间创建 `config.databases` 集合，时间点恢复失败的问题

* [PBM-1316](https://perconadev.atlassian.net/browse/PBM-1316) - 防止在备份进行时运行 pbm cleanup

* [PBM-1338](https://perconadev.atlassian.net/browse/PBM-1338) - 为 `describe-restore` 命令输出添加开始和完成时间 

* [PBM-1356](https://perconadev.atlassian.net/browse/PBM-1356) - 通过在创建集合后稍后开始日志记录，修复了 pbm 命令失败的问题

* [PBM-1369](https://perconadev.atlassian.net/browse/PBM-1369) - 修复了当 `pbm-agent` 在 `dumpDone` 阶段后丢失时逻辑备份卡住的问题。 

* [PBM-1382](https://perconadev.atlassian.net/browse/PBM-1382) - 修复了 pbm status 输出中延迟节点的优先级显示

* [PBM-1387](https://perconadev.atlassian.net/browse/PBM-1387) - 修复了不显示配置选项默认值的问题 

* [PBM-1391](https://perconadev.atlassian.net/browse/PBM-1391) - 修复了在物理恢复后启用时间点恢复例程后 Percona Server for MongoDB 崩溃的问题




