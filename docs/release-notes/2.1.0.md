# Percona Backup for MongoDB 2.1.0 (2023-04-18)

| 发布日期 | 2023 年 4 月 18 日  |
|------------- | ---------------|
| 安装 | [安装 Percona Backup for MongoDB](../installation.md) |


Percona Backup for MongoDB 是一个分布式、低影响的解决方案，用于创建 MongoDB 分片集群和副本集的一致备份。这是一个用于在 MongoDB 分片集群（或非分片副本集）中创建一致备份并将这些备份恢复到特定时间点的工具。

## 发布亮点

* [增量物理备份](../features/incremental-backup.md) 现已正式可用，使您可以在生产环境中使用它们。请注意，由于恢复所需的元数据文件更改，使用以前 PBM 版本创建的备份与 PBM 2.1.0 的恢复不兼容。
* 您现在可以[选择性地备份和恢复分片集合](../features/selective-backup.md#sharded-collections)。这改善了分片集群中所需数据子集的管理，并为您节省数据存储和传输的额外成本。由于一些[已知限制](../features/known-limitations.md#selective-backups-and-restores)，这是技术预览功能。
* 通过支持[从 S3 存储并行下载数据块](../usage/restore-physical.md#parallel-data-download)，物理恢复性能提升高达 19 倍。
* 改进了删除旧备份和时间点恢复 oplog 块的功能，简化了备份存储清理的自动化。
* 改进了 Percona Server for MongoDB 中静态数据加密的主密钥处理，以及 PBM 从备份中检索密钥 ID/密钥路径，简化了物理恢复的环境准备并改善了恢复流程。
* 支持 AWS 令牌访问 S3 存储，提高了基础设施的安全性，并改善了与通过令牌与 AWS 资源交互的应用程序的集成。

## 新功能

* [PBM-1007](https://jira.percona.com/browse/PBM-1007) - 分片集合的选择性备份/恢复

## 改进

* [PBM-850](https://jira.percona.com/browse/PBM-850) - 添加删除旧备份的能力
* [PBM-875](https://jira.percona.com/browse/PBM-875) - 从 S3 兼容存储并发下载
* [PBM-778](https://jira.percona.com/browse/PBM-778) - 在存储上保存物理恢复日志
* [PBM-951](https://jira.percona.com/browse/PBM-951) - 摆脱冗余的 `pbm*.old` 集合以提高重新同步速度
* [PBM-955](https://jira.percona.com/browse/PBM-955) - 改进静态数据加密的物理恢复
* [PBM-1033](https://jira.percona.com/browse/PBM-1033) - 在进行新的基础备份后刷新先前的增量备份历史记录
* [PBM-1034](https://jira.percona.com/browse/PBM-1034) - 仅恢复目标备份中列出的文件，并删除增量备份不需要的文件
* [PBM-1035](https://jira.percona.com/browse/PBM-1035) - 在 `pbm status` 输出中指示基础增量备份
* [PBM-1046](https://jira.percona.com/browse/PBM-1046) - 处理偏移量超出当前文件大小的更改以进行增量备份
* [PBM-1053](https://jira.percona.com/browse/PBM-1053) - 在物理恢复期间在配置服务器之前停止分片上的 mongod
* [PBM-1060](https://jira.percona.com/browse/PBM-1060) - 添加 AWS 会话令牌支持以访问 S3 存储
* [PBM-1066](https://jira.percona.com/browse/PBM-1066) - 从在先前主要 PSMDB 版本上制作的逻辑备份恢复
* [PBM-1070](https://jira.percona.com/browse/PBM-1070) - 在使用 `--wait` 选项运行 pbm restore 时改进对失败的物理/增量恢复的处理
* [PBM-1078](https://jira.percona.com/browse/PBM-1078) - 在中间重启期间保留 vault 选项
* [PBM-1085](https://jira.percona.com/browse/PBM-1085) - 为使用 `--force` 的命令添加 `--yes` 标志

## 已修复的错误

* [PBM-979](https://jira.percona.com/browse/PBM-979) - 在物理恢复上添加对延迟/仲裁节点的支持
* [PBM-1012](https://jira.percona.com/browse/PBM-1012) - 在创建集合阶段的选择性 oplog 重放期间删除集合
* [PBM-1030](https://jira.percona.com/browse/PBM-1030) - 修复了如果数据在备份期间添加/删除，从具有静态数据加密的数据库的增量备份恢复的问题
* [PBM-1052](https://jira.percona.com/browse/PBM-1052) - 修复了在比备份中具有更多分片的集群上进行物理恢复时 PBM 的错误行为
* [PBM-1061](https://jira.percona.com/browse/PBM-1061) - 修复了在 PSMDB 4.2 上使用副本集名称重映射的恢复
* [PBM-1063](https://jira.percona.com/browse/PBM-1063) - 修复了如果在 PSMDB 中配置了 `directoryPerDb`，增量恢复失败的问题
* [PBM-1069](https://jira.percona.com/browse/PBM-1069) - 检查不兼容的增量备份，并在 `pbm status` 输出中相应通知
* [PBM-1073](https://jira.percona.com/browse/PBM-1073) - 在具有大型数据集和许多备份的环境中改进 `pbm status` 命令的性能
* [PBM-1077](https://jira.percona.com/browse/PBM-1077) - 保存 `storage.bson` 以确保具有静态数据加密的数据库的增量备份和恢复

 